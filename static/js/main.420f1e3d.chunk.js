(this["webpackJsonplogin-example"]=this["webpackJsonplogin-example"]||[]).push([[0],{30:function(e,t,r){e.exports=r(42)},35:function(e,t,r){},36:function(e,t,r){},42:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(16),o=r.n(s),i=(r(35),r(36),r(2)),c=r(4),l=r(29),u=JSON.parse(localStorage.getItem("users"))||[];var m=r(6),f=Object(m.a)();function d(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token}:{}}var g=r(10),E=r(27),p=r(28),h="SUCCESS",v="ERROR",b="CLEAR",S="USERS_REGISTER_REQUEST",N="USERS_REGISTER_SUCCESS",O="USERS_REGISTER_FAILURE",y="USERS_LOGIN_REQUEST",j="USERS_LOGIN_SUCCESS",U="USERS_LOGIN_FAILURE",R="USERS_LOGOUT",w="USERS_GETALL_REQUEST",k="USERS_GETALL_SUCCESS",T="USERS_GETALL_FAILURE",L="USERS_DELETE_REQUEST",I="USERS_DELETE_SUCCESS",_="USERS_DELETE_FAILURE",C=JSON.parse(localStorage.getItem("user")),x=C?{loggedIn:!0,user:C}:{};var A=r(19),J=r(3);var P=Object(g.c)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return{loggingIn:!0,user:t.user};case j:return{loggedIn:!0,user:t.user};case U:case R:return{};default:return e}},registration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return{registering:!0};case N:case O:return{};default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return{loading:!0};case k:return{items:t.users};case T:return{error:t.error};case L:return Object(J.a)(Object(J.a)({},e),{},{items:e.items.map((function(e){return e.id===t.id?Object(J.a)(Object(J.a)({},e),{},{deleting:!0}):e}))});case I:return{items:e.items.filter((function(e){return e.id!==t.id}))};case _:return Object(J.a)(Object(J.a)({},e),{},{items:e.items.map((function(e){if(e.id===t.id){e.deleting;var r=Object(A.a)(e,["deleting"]);return Object(J.a)(Object(J.a)({},r),{},{deleteError:t.error})}return e}))});default:return e}},alert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return{type:"alert-success",message:t.message};case v:return{type:"alert-danger",message:t.message};case b:return{};default:return e}}}),G=Object(p.createLogger)(),D=Object(g.d)(P,Object(g.a)(E.a,G)),B={success:function(e){return{type:h,message:e}},error:function(e){return{type:v,message:e}},clear:function(){return{type:b}}};var q={appUri:"http://localhost:3000/"},F={login:function(e,t){var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return fetch("".concat(q.apiUrl,"/users/authenticate"),r).then(z).then((function(e){return localStorage.setItem("user",JSON.stringify(e)),e}))},logout:W,register:function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("".concat(q.apiUrl,"/users/register"),t).then(z)},getAll:function(){var e={method:"GET",headers:d()};return fetch("".concat(q.apiUrl,"/users"),e).then(z)},getById:function(e){var t={method:"GET",headers:d()};return fetch("".concat(q.apiUrl,"/users/").concat(e),t).then(z)},update:function(e){var t={method:"PUT",headers:Object(J.a)(Object(J.a)({},d()),{},{"Content-Type":"application/json"}),body:JSON.stringify(e)};return fetch("".concat(q.apiUrl,"/users/").concat(e.id),t).then(z)},delete:function(e){var t={method:"DELETE",headers:d()};return fetch("".concat(q.apiUrl,"/users/").concat(e),t).then(z)}};function W(){localStorage.removeItem("user")}function z(e){return e.text().then((function(t){var r=t&&JSON.parse(t);if(!e.ok){401===e.status&&(W(),location.reload(!0));var n=r&&r.message||e.statusText;return Promise.reject(n)}return r}))}var Q={login:function(e,t){return function(r){r({type:y,user:{username:e}}),F.login(e,t).then((function(e){r(function(e){return{type:j,user:e}}(e)),f.push("/")}),(function(e){r(function(e){return{type:U,error:e}}(e.toString())),r(B.error(e.toString()))}))}},logout:function(){return F.logout(),{type:R}},register:function(e){return function(t){t(function(e){return{type:S,user:e}}(e)),F.register(e).then((function(e){t(function(e){return{type:N,user:e}}()),f.push("/login"),t(B.success("Registration successful"))}),(function(e){t(function(e){return{type:O,error:e}}(e.toString())),t(B.error(e.toString()))}))}},getAll:function(){return function(e){e({type:w}),F.getAll().then((function(t){return e(function(e){return{type:k,users:e}}(t))}),(function(t){return e(function(e){return{type:T,error:e}}(t.toString()))}))}},delete:function(e){return function(t){t(function(e){return{type:L,id:e}}(e)),F.delete(e).then((function(r){return t(function(e){return{type:I,id:e}}(e))}),(function(r){return t(function(e,t){return{type:_,id:e,error:t}}(e,r.toString()))}))}}};var M=function(e){var t=e.component,r=Object(A.a)(e,["component"]);return a.a.createElement(i.b,Object.assign({},r,{render:function(e){return localStorage.getItem("user")?a.a.createElement(t,e):a.a.createElement(i.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},$=r(9);function H(){var e=Object(c.c)((function(e){return e.users})),t=Object(c.c)((function(e){return e.authentication.user})),r=Object(c.b)();return Object(n.useEffect)((function(){r(Q.getAll())}),[r]),a.a.createElement("div",{className:"col-lg-8 offset-lg-2"},a.a.createElement("h1",null,"Hi ",t.firstName,"!"),a.a.createElement("p",null,"You're logged in with React Hooks!!"),a.a.createElement("h3",null,"All registered users:"),e.loading&&a.a.createElement("em",null,"Loading users..."),e.error&&a.a.createElement("span",{className:"text-danger"},"ERROR: ",e.error),e.items&&a.a.createElement("ul",null,e.items.map((function(e,t){return a.a.createElement("li",{key:e.id},e.firstName+" "+e.lastName,e.deleting?a.a.createElement("em",null," - Deleting..."):e.deleteError?a.a.createElement("span",{className:"text-danger"}," ","- ERROR: ",e.deleteError):a.a.createElement("span",null," ","-"," ",a.a.createElement("a",{onClick:function(){return t=e.id,void r(Q.delete(t));var t},className:"text-primary"},"Delete")))}))),a.a.createElement("p",null,a.a.createElement($.a,{to:"/login"},"Logout")))}var Y=r(12),K=r(13);function V(){var e=Object(n.useState)({username:"",password:""}),t=Object(K.a)(e,2),r=t[0],s=t[1],o=Object(n.useState)(!1),i=Object(K.a)(o,2),l=i[0],u=i[1],m=r.username,f=r.password,d=Object(c.c)((function(e){return e.authentication.loggingIn})),g=Object(c.b)();function E(e){var t=e.target,r=t.name,n=t.value;s((function(e){return Object(J.a)(Object(J.a)({},e),{},Object(Y.a)({},r,n))}))}return Object(n.useEffect)((function(){g(Q.logout())}),[g]),a.a.createElement("div",{className:"col-lg-8 offset-lg-2"},a.a.createElement("h2",null,"Login"),a.a.createElement("form",{name:"form",onSubmit:function(e){e.preventDefault(),u(!0),m&&f&&g(Q.login(m,f))}},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",null,"Username"),a.a.createElement("input",{type:"text",name:"username",value:m,onChange:E,className:"form-control"+(l&&!m?" is-invalid":"")}),l&&!m&&a.a.createElement("div",{className:"invalid-feedback"},"Username is required")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",null,"Password"),a.a.createElement("input",{type:"password",name:"password",value:f,onChange:E,className:"form-control"+(l&&!f?" is-invalid":"")}),l&&!f&&a.a.createElement("div",{className:"invalid-feedback"},"Password is required")),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-primary"},d&&a.a.createElement("span",{className:"spinner-border spinner-border-sm mr-1"}),"Login"),a.a.createElement($.a,{to:"/register",className:"btn btn-link"},"Register"))))}function X(){var e=Object(n.useState)({firstName:"",lastName:"",username:"",password:""}),t=Object(K.a)(e,2),r=t[0],s=t[1],o=Object(n.useState)(!1),i=Object(K.a)(o,2),l=i[0],u=i[1],m=Object(c.c)((function(e){return e.registration.registering})),f=Object(c.b)();function d(e){var t=e.target,r=t.name,n=t.value;s((function(e){return Object(J.a)(Object(J.a)({},e),{},Object(Y.a)({},r,n))}))}return Object(n.useEffect)((function(){f(Q.logout())}),[f]),a.a.createElement("div",{className:"col-lg-8 offset-lg-2"},a.a.createElement("h2",null,"Register"),a.a.createElement("form",{name:"form",onSubmit:function(e){e.preventDefault(),u(!0),r.firstName&&r.lastName&&r.username&&r.password&&f(Q.register(r))}},a.a.createElement("div",{className:"form-group"},a.a.createElement("label",null,"First Name"),a.a.createElement("input",{type:"text",name:"firstName",value:r.firstName,onChange:d,className:"form-control"+(l&&!r.firstName?" is-invalid":"")}),l&&!r.firstName&&a.a.createElement("div",{className:"invalid-feedback"},"First Name is required")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",null,"Last Name"),a.a.createElement("input",{type:"text",name:"lastName",value:r.lastName,onChange:d,className:"form-control"+(l&&!r.lastName?" is-invalid":"")}),l&&!r.lastName&&a.a.createElement("div",{className:"invalid-feedback"},"Last Name is required")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",null,"Username"),a.a.createElement("input",{type:"text",name:"username",value:r.username,onChange:d,className:"form-control"+(l&&!r.username?" is-invalid":"")}),l&&!r.username&&a.a.createElement("div",{className:"invalid-feedback"},"Username is required")),a.a.createElement("div",{className:"form-group"},a.a.createElement("label",null,"Password"),a.a.createElement("input",{type:"password",name:"password",value:r.password,onChange:d,className:"form-control"+(l&&!r.password?" is-invalid":"")}),l&&!r.password&&a.a.createElement("div",{className:"invalid-feedback"},"Password is required")),a.a.createElement("div",{className:"form-group"},a.a.createElement("button",{className:"btn btn-primary"},m&&a.a.createElement("span",{className:"spinner-border spinner-border-sm mr-1"}),"Register"),a.a.createElement($.a,{to:"/login",className:"btn btn-link"},"Cancel"))))}var Z=function(){var e=Object(c.c)((function(e){return e.alert})),t=Object(c.b)();return Object(n.useEffect)((function(){f.listen((function(e,r){t(B.clear())}))}),[t]),a.a.createElement("div",{className:"jumbotron"},a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"col-md-8 offset-md-2"},e.message&&a.a.createElement("div",{className:"alert ".concat(e.type)},e.message),a.a.createElement(i.c,{history:f},a.a.createElement(i.d,null,a.a.createElement(M,{exact:!0,path:"/",component:H}),a.a.createElement(i.b,{path:"/login",component:V}),a.a.createElement(i.b,{path:"/register",component:X}),a.a.createElement(i.a,{from:"*",to:"/"}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=window.fetch;window.fetch=function(t,r){return new Promise((function(n,a){setTimeout((function(){if(t.endsWith("/users/authenticate")&&"POST"===r.method){var s=JSON.parse(r.body),o=u.filter((function(e){return e.username===s.username&&e.password===s.password}));if(o.length){var i=o[0],c={id:i.id,username:i.username,firstName:i.firstName,lastName:i.lastName,token:"fake-jwt-token"};n({ok:!0,text:function(){return Promise.resolve(JSON.stringify(c))}})}else a("Username or password is incorrect")}else if(t.endsWith("/users")&&"GET"===r.method)r.headers&&"Bearer fake-jwt-token"===r.headers.Authorization?n({ok:!0,text:function(){return Promise.resolve(JSON.stringify(u))}}):a("Unauthorised");else if(t.match(/\/users\/\d+$/)&&"GET"===r.method)if(r.headers&&"Bearer fake-jwt-token"===r.headers.Authorization){var m=t.split("/"),f=parseInt(m[m.length-1]),d=u.filter((function(e){return e.id===f})),g=d.length?d[0]:null;n({ok:!0,text:function(){return JSON.stringify(g)}})}else a("Unauthorised");else{if(t.endsWith("/users/register")&&"POST"===r.method){var E=JSON.parse(r.body);return u.filter((function(e){return e.username===E.username})).length?void a('Username "'+E.username+'" is already taken'):(E.id=u.length?Math.max.apply(Math,Object(l.a)(u.map((function(e){return e.id}))))+1:1,u.push(E),localStorage.setItem("users",JSON.stringify(u)),void n({ok:!0,text:function(){return Promise.resolve()}}))}if(t.match(/\/users\/\d+$/)&&"DELETE"===r.method)if(r.headers&&"Bearer fake-jwt-token"===r.headers.Authorization){for(var p=t.split("/"),h=parseInt(p[p.length-1]),v=0;v<u.length;v++){if(u[v].id===h){u.splice(v,1),localStorage.setItem("users",JSON.stringify(u));break}}n({ok:!0,text:function(){return Promise.resolve()}})}else a("Unauthorised");else e(t,r).then((function(e){return n(e)}))}}),500)}))}}(),o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(c.a,{store:D},a.a.createElement(Z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.420f1e3d.chunk.js.map